const e="https://photon.komoot.io";let t={geoLocation:{},record:{}};const a=async function(a,r){try{let n;if(!(n=a?await fetch(`${e}/api/?q=${a}&limit=1`):await fetch(`${e}/reverse/?lat=${r.lat}&lon=${r.lng}`)).ok)throw Error("Failed to fetch geolocation data");let i=await n.json();if(!i||0===i.features.length)throw Error("Location not found. Please enter a valid city name.");return t.geoLocation={country:(i=i.features[0]).properties.country,region:i.properties.state,city:i.properties.name,lat:i.geometry.coordinates[1],lng:i.geometry.coordinates[0]},t.geoLocation}catch(e){throw e}},r=async function(e){try{if(!e.lat||!e.lng)throw Error("Invalid coordinates for weather data");let a=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${e.lat}&longitude=${e.lng}&daily=temperature_2m_max,temperature_2m_min,weather_code,sunrise,sunset,uv_index_max,daylight_duration,sunshine_duration&hourly=temperature_2m,relative_humidity_2m,precipitation_probability,precipitation,rain,visibility,cloud_cover,surface_pressure,wind_speed_10m,wind_direction_10m,wind_gusts_10m,temperature_80m,uv_index,apparent_temperature,weather_code,is_day&current=temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code,cloud_cover,surface_pressure,wind_speed_10m,wind_direction_10m,wind_gusts_10m,rain,is_day&timezone=auto`);if(!a.ok){let e="Weather data not found.";throw 401===a.status||403===a.status?e="Invalid API Key or Access Forbidden.":429===a.status?e="Too Many Requests. Please try again later.":a.status>=500&&(e="Server Error. Please try again later."),Error(e)}let r=await fetch(`https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${e.lat}&longitude=${e.lng}&hourly=pm2_5,pm10,carbon_monoxide,nitrogen_dioxide,ozone&timezone=auto&forecast_days=5`);if(!r.ok)throw Error("Failed to fetch air quality data");let n=await a.json();if(!n)throw Error("Invalid API data received");let i=await r.json();if(!n)throw Error("Invalid API data received");let o=new Date(n.current.time);return t.record={realHour:o.getHours(),location:{country:e.country,region:e.region,city:e.city,latitude:e.lat,longitude:e.lng,curDate:o.getDate(),curMonth:o.getMonth()+1,curYear:o.getFullYear(),curWeekDay:o.getDay(),curTime:n.current.time.split("T")[1]},current:n.current,currentUnits:n.current_units,currentTime:n.current.time,currentIsDay:n.current.is_day,daily:n.daily,dailyUnits:n.daily_units,sunrise:n.daily.sunrise,sunset:n.daily.sunset,date:n.daily.time,dailyWeatherCode:n.daily.weather_code,maxTempC:n.daily.temperature_2m_max,minTempC:n.daily.temperature_2m_min,hourly:n.hourly,hourlyUnits:n.hourly_units,aqi:{co:i.hourly.carbon_monoxide,no2:i.hourly.nitrogen_dioxide,o3:i.hourly.ozone,pm2_5:i.hourly.pm2_5,pm10:i.hourly.pm10,time:i.hourly.time},chanceOfRain:n.hourly.precipitation_probability,precip:n.hourly.precipitation,rain:n.hourly.rain,cloud:n.hourly.cloud_cover,feelsLikeC:n.hourly.apparent_temperature,humidity:n.hourly.relative_humidity_2m,pressure:n.hourly.surface_pressure,tempC2:n.hourly.temperature_2m,tempC80:n.hourly.temperature_80m,time:n.hourly.time,isDay:n.hourly.is_day,uvIndex:n.hourly.uv_index,visibility:n.hourly.visibility,weatherCode:n.hourly.weather_code,gust:n.hourly.wind_gusts_10m,windDirection:n.hourly.wind_direction_10m,windSpeed:n.hourly.wind_speed_10m,tempScale:"C"},t.record}catch(e){throw e}},n=function(){if(!t.record||0===Object.keys(t.record).length)throw Error("No weather data available. Please search for a city first.");return t.record.tempScale="C"===t.record.tempScale?"F":"C",t.record},i=function(){t.record=null,t.geoLocation={}};class o{_data;_initialMarkup;saveInitialMarkup(){this._initialMarkup||(this._initialMarkup=this._parentElement.innerHTML)}render(e){e&&(this._data=e,this._renderForecast())}_clear(){this._parentElement.innerHTML=""}_renderIcons(){let e=this._parentElement.querySelector("[data-climate-icon]"),t=this._parentElement.querySelector("[data-climate-img]");e&&t&&(e.classList.add("hidden"),t.classList.remove("hidden"))}_updateElements(e){e.forEach(({selector:e,content:t,attribute:a="textContent"})=>{let r=this._parentElement.querySelector(e);r?("textContent"===a?r.textContent=t:r.setAttribute(a,t),"[data-climate-img]"===e&&(console.log(`Setting ${a} to:`,t),console.log("Element found:",r),console.log("Final src value:",r.src))):console.log(`Element not found for selector: ${e}`)})}_renderDegScale(e,t){return"c"===this._data.tempScale?e:t}renderSpinner(){let e=this._displayElement||this._parentElement,t=`
      <div class="spinner" id="weather-spinner">
        <i data-lucide="loader"></i>
      </div>
    `;e.innerHTML="",e.insertAdjacentHTML("afterbegin",t),window.lucide&&window.lucide.createIcons()}renderError(e){let t=`
        <div class="error">
          <div>
            <i data-lucide="circle-x"></i>
          </div>
          <p>${e}</p>
        </div>
    `,a=this._displayElement||this._parentElement;a.innerHTML="",a.insertAdjacentHTML("afterBegin",t)}restoreInitial(){let e=this._displayElement||this._parentElement;this._initialMarkup&&(e.innerHTML=this._initialMarkup)}}class s extends o{_parentElement=document.getElementById("input__city");getQuery(){let e=this._parentElement.value.toLowerCase().trim();return this._parentElement.value="",this._parentElement.blur(),e}addHandlerLocation(e){document.querySelector(".navbar__search").addEventListener("submit",t=>{t.preventDefault();let a=this.getQuery();if(!a)return alert("Please enter the city name");e(a)})}addHandler(e){document.addEventListener("DOMContentLoaded",e)}}var d=new s;const c=e=>{let[t,a]=e.split(":").map(Number),r=t>=12?"PM":"AM";return t=t%12||12,`${t}:${a.toString().padStart(2,"0")} ${r}`},l=e=>9*e/5+32,u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=(e,t=!0)=>{let a={0:{description:"Clear sky",dayIcon:"clear-day.svg",nightIcon:"clear-night.svg"},1:{description:"Mainly clear",dayIcon:"clear-day.svg",nightIcon:"clear-night.svg"},2:{description:"Partly cloudy",dayIcon:"partly-cloudy-day.svg",nightIcon:"partly-cloudy-night.svg"},3:{description:"Overcast",dayIcon:"overcast-day.svg",nightIcon:"overcast-night.svg"},45:{description:"Fog",dayIcon:"fog-day.svg",nightIcon:"fog-night.svg"},48:{description:"Depositing rime fog",dayIcon:"fog-day.svg",nightIcon:"fog-night.svg"},51:{description:"Drizzle light",dayIcon:"partly-cloudy-day-drizzle.svg",nightIcon:"partly-cloudy-night-drizzle.svg"},53:{description:"Drizzle moderate",dayIcon:"partly-cloudy-day-drizzle.svg",nightIcon:"partly-cloudy-night-drizzle.svg"},55:{description:"Drizzle heavy",dayIcon:"drizzle.svg",nightIcon:"drizzle.svg"},56:{description:"Freezing drizzle light",dayIcon:"partly-cloudy-day-sleet.svg",nightIcon:"partly-cloudy-night-sleet.svg"},57:{description:"Freezing drizzle heavy",dayIcon:"drizzle.svg",nightIcon:"drizzle.svg"},61:{description:"Rain slight",dayIcon:"partly-cloudy-day-rain.svg",nightIcon:"partly-cloudy-night-rain.svg"},63:{description:"Rain moderate",dayIcon:"rain.svg",nightIcon:"rain.svg"},65:{description:"Rain heavy",dayIcon:"rain.svg",nightIcon:"rain.svg"},66:{description:"Freezing rain light",dayIcon:"sleet.svg",nightIcon:"sleet.svg"},67:{description:"Freezing rain heavy",dayIcon:"sleet.svg",nightIcon:"sleet.svg"},71:{description:"Snow fall slight",dayIcon:"partly-cloudy-day-snow.svg",nightIcon:"partly-cloudy-night-snow.svg"},73:{description:"Snow fall moderate",dayIcon:"snow.svg",nightIcon:"snow.svg"},75:{description:"Snow fall heavy",dayIcon:"snow.svg",nightIcon:"snow.svg"},77:{description:"Snow grains",dayIcon:"snow.svg",nightIcon:"snow.svg"},80:{description:"Rain Showers light",dayIcon:"partly-cloudy-day-rain.svg",nightIcon:"partly-cloudy-night-rain.svg"},81:{description:"Rain Showers moderate",dayIcon:"rain.svg",nightIcon:"rain.svg"},82:{description:"Rain Showers violent",dayIcon:"rain.svg",nightIcon:"rain.svg"},85:{description:"Snow Showers slight",dayIcon:"partly-cloudy-day-snow.svg",nightIcon:"partly-cloudy-night-snow.svg"},86:{description:"Snow Showers heavy",dayIcon:"snow.svg",nightIcon:"snow.svg"},95:{description:"Thunderstorms",dayIcon:"thunderstorms-day.svg",nightIcon:"thunderstorms-night.svg"},96:{description:"Thunderstorms with hail",dayIcon:"thunderstorms-day-rain.svg",nightIcon:"thunderstorms-night-rain.svg"},99:{description:"Heavy thunderstorms",dayIcon:"thunderstorms-rain.svg",nightIcon:"thunderstorms-rain.svg"}}[e]||{description:"Unknown weather",dayIcon:"not-available.svg",nightIcon:"not-available.svg"},r=t?a.dayIcon:a.nightIcon;return{description:a.description,icon:"https://cdn.jsdelivr.net/gh/basmilius/weather-icons/production/fill/all/"+r}};class y extends o{_parentElement=document.querySelector(".sidebar");_displayElement=this._parentElement.querySelector("[data-location]");_renderForecast(){let e,t,a;this._renderIcons();let r=this._data.realHour,n=`${this._data.location.city}, ${this._data.location.region}, ${this._data.location.country}`,i="C"===this._data.tempScale?"C":"F";"C"===i?(e=Math.round(this._data.minTempC[0]),t=Math.round(this._data.maxTempC[0]),a=Math.round(this._data.tempC80[r])):(e=Math.round(l(this._data.minTempC[0])),t=Math.round(l(this._data.maxTempC[0])),a=Math.round(l(this._data.tempC80[r])));let o=c(this._data.location.curTime),s=c(this._data.sunrise[0].split("T")[1]),d=c(this._data.sunset[0].split("T")[1]),y=0!==this._data.isDay[r],{description:p,icon:g}=h(this._data.weatherCode[r],y),{description:m,icon:_}=h(this._data.dailyWeatherCode[0],!0);this._updateElements([{selector:"[data-location]",content:n},{selector:"[data-currTemp]",content:a},{selector:"[data-tempDeg]",content:i},{selector:"[data-weekday]",content:u[this._data.location.curWeekDay]},{selector:"[data-time]",content:o},{selector:"[data-climate-des]",content:p},{selector:".event--icon",content:g,attribute:"src"},{selector:".main__event--icon",content:_,attribute:"src"},{selector:"[data-mintemp]",content:e},{selector:"[data-maxtemp]",content:t},{selector:"[data-sunrise]",content:s},{selector:"[data-sunset]",content:d}])}}var p=new y;class g extends o{_parentElement=document.querySelector(".week-report--js");_renderForecast(){this._clear();let e=this._renderMarkup();this._parentElement.insertAdjacentHTML("afterbegin",e)}_renderMarkup(){return`
          <h1 class="heading-1">This Week Weather Report</h1>
          <div class="content__report--card-container">
          ${this._data.date.map((e,t)=>this._renderMarkupGenerator(this._data,t)).join("")}
          </div>
    `}_renderMarkupGenerator(e,t){let a,r,n=new Date(e.date[t]);n.toLocaleDateString("en-US",{year:"numeric"});let i=n.toLocaleDateString("en-US",{month:"short"}),o=n.toLocaleDateString("en-US",{day:"2-digit"}),s=n.toLocaleDateString("en-US",{weekday:"short"}),{description:d,icon:c}=h(e.dailyWeatherCode[t],!0);return"C"==("C"===e.tempScale?"C":"F")?(a=Math.round(e.maxTempC[t]),r=Math.round(e.minTempC[t])):(a=Math.round(l(e.maxTempC[t])),r=Math.round(l(e.minTempC[t]))),`
            <div class="day__card">
                <div class="day__card--date">
                  <span>${o} ${i}</span>
                  <span>${s}</span>
                </div>
                <div class="day__card--climate">
                  <img class="icon icon--gold-fill" src="${c}"  data-lucide="cloudy" alt="${d}" title="${d}" />
                  <span>${r}&deg; / ${a}&deg;</span>
                </div>
            </div>
        `}}var m=new g;class _ extends o{_parentElement=document.querySelector(".forecast-container");_renderForecast(){var e;let t,a=this._data.realHour,r=Math.trunc(this._data.uvIndex[a]),n=this._data.windSpeed[a],i=["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"][Math.floor(this._data.windDirection[a]/22.5)%16],o=Math.round(.001*this._data.visibility[a]),s=this._data.cloud[a],d=this._data.precip[a],c=this._data.humidity[a],{aqi:u,category:h}=(e=this._data.aqi.pm2_5[a])<=12?{aqi:Math.trunc(50/12*e),category:"Good"}:e<=35.4?{aqi:Math.trunc(51+49/23.4*(e-12.1)),category:"Moderate"}:e<=55.4?{aqi:Math.trunc(101+2.45*(e-35.5)),category:"Unhealthy for Sensitive Groups"}:e<=150.4?{aqi:Math.trunc(151+49/95*(e-55.5)),category:"Unhealthy"}:e<=250.4?{aqi:Math.trunc(201+.99*(e-150.5)),category:"Very Unhealthy"}:{aqi:Math.trunc(301+199/149.5*(e-250.5)),category:"Hazardous"},y="C"===this._data.tempScale?"C":"F",p=((e,t="C")=>{let a,r="C"===t?[0,11,21,26,31,36]:[32,51,69,78,87,96],n=["Freezing","Cold","Cool","Pleasant","Warm","Hot","Very Hot"];for(let t=0;t<r.length;t++)e>r[r.length-1]?a=n[n.length-1]:e<=r[t]&&(a=n[t]);return a})(t="C"===y?Math.round(this._data.feelsLikeC[a])-1:Math.round(l(this._data.feelsLikeC[a]))-1,y);this._updateElements([{selector:"[data-feelslike]",content:`${t}\xb0`},{selector:"[data-tempDeg]",content:y},{selector:"[data-feelslike-des]",content:p},{selector:"[data-uv-index]",content:r},{selector:"[data-uv-index-des]",content:0===r?"Excellent":r<=2?"Low":r<=5?"Moderate":r<=7?"High":r<=10?"Very High":"Extreme"},{selector:"[data-wind-speed]",content:n},{selector:"[data-wind-dir]",content:i},{selector:"[data-cloud]",content:s},{selector:"[data-cloud-des]",content:s<=10?"Clear":s<=25?"Mostly Clear":s<=50?"Partly Cloudy":s<=69?"Mostly Cloudy":s<=89?"Overcast":"Very Overcast"},{selector:"[data-precip]",content:d},{selector:"[data-precip-des]",content:0===d?"No Rain":d<=2.5?"Light Rain":d<=7.5?"Moderate Rain":d<=50?"Heavy Rain":"Very Heavy Rain"},{selector:"[data-vis]",content:o},{selector:"[data-vis-des]",content:o>10?"Clear":o>=6?"Mostly Clear":o>=4?"Slightly Hazy":o>=2?"Hazy":o>=1?"Low Visibility":"Very Low Visibility"},{selector:"[data-humidity]",content:c},{selector:"[data-humidity-des]",content:c<=30?"Dry":c<=50?"Comfortable":c<=65?"Slightly Humid":c<=75?"Humid":c<=85?"Very Humid":"Oppressive"},{selector:"[data-aqi-us]",content:u},{selector:"[data-aqi-us-des]",content:h}])}}var v=new _;class w extends o{_parentElement=document.getElementById("get-geolocation");addHandlerGeoLocation(e){this._parentElement.addEventListener("click",e)}}var I=new w;class f extends o{_parentElement=document.querySelector(".temp__box-btns");_slider=this._parentElement.querySelector(".slider__btn");_celsiusBtn=document.querySelector(".temp__btn-C");_fahrenheitBtn=document.querySelector(".temp__btn-F");addHandlerToggleScale(e){this._parentElement.addEventListener("click",t=>{let a=t.target.closest(".temp__btn");a&&(a.classList.contains("active")||e())})}updateActiveBtn(e){"C"===e?(this._celsiusBtn.classList.add("active"),this._fahrenheitBtn.classList.remove("active"),this._slider.classList.remove("slide-right")):(this._celsiusBtn.classList.remove("active"),this._fahrenheitBtn.classList.add("active"),this._slider.classList.add("slide-right"))}}var S=new f;const E=async function(){try{p.renderSpinner();let e=await new Promise(function(e,t){if(!navigator.geolocation)return void t(Error("Geolocation is not supported in this Browser"));navigator.geolocation.getCurrentPosition(t=>{let{latitude:a,longitude:r}=t.coords;e({lat:a,lng:r})},e=>t(e))});if(!e)throw Error("Unable to retrieve geolocation");M(null,e)}catch(e){p.renderError(e.message),m.restoreInitial(),v.restoreInitial()}},M=async function(e,t){try{m.restoreInitial(),v.restoreInitial(),p.renderSpinner(),m.renderSpinner();let n=await a(e||null,t||null),i=await r(n);p.render(i),m.render(i),v.render(i),S.updateActiveBtn(i.tempScale)}catch(e){i(),p.renderError(e.message),m.restoreInitial(),v.restoreInitial()}};document.addEventListener("DOMContentLoaded",function(){m.saveInitialMarkup(),p.saveInitialMarkup(),v.saveInitialMarkup()}),d.addHandlerLocation(M),I.addHandlerGeoLocation(E),S.addHandlerToggleScale(function(){try{let e=n();if(!e)return;S.updateActiveBtn(e.tempScale),p.render(e),m.render(e),v.render(e)}catch(e){p.renderError(e.message)}});
//# sourceMappingURL=flying-Nimbus.f94b857e.js.map
